<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kid Sequencer</title>

  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f4f4f4; }
    .locked button.locked { opacity:0.4; pointer-events:none; }
    .logout { color:#e00000 !important; }
  </style>
</head>

<body>
  <!-- Header -->
  <header>
    <button id="authBtn">Login</button>
  </header>

  <!-- Main app (unchanged layout) -->
  <main id="app">
    <button class="tempo locked">Tempo +</button>
    <button class="tempo locked">Tempo -</button>
    <button class="camera locked">Camera</button>
    <button class="sound locked">Sound Select</button>
    <img src="robot.svg" alt="Robot" id="robot">
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getAuth, setPersistence, browserSessionPersistence, signOut } 
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBokU1u4hJIxZ0Y4U9BxQreI3hnxEJzuwc",
      authDomain: "kid-sequencer.firebaseapp.com",
      projectId: "kid-sequencer",
      storageBucket: "kid-sequencer.firebasestorage.app",
      messagingSenderId: "715996068165",
      appId: "1:715996068165:web:84e127454cb9bb0c35a62c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    setPersistence(auth, browserSessionPersistence);

    const authBtn = document.getElementById("authBtn");
    const appEl = document.getElementById("app");

    function applyState() {
      const loggedIn = sessionStorage.getItem("kidseq_logged_in") === "1";
      appEl.classList.toggle("locked", !loggedIn);
      authBtn.textContent = loggedIn ? "Logout" : "Login";
      authBtn.classList.toggle("logout", loggedIn);
    }

    authBtn.addEventListener("click", async () => {
      const loggedIn = sessionStorage.getItem("kidseq_logged_in") === "1";
      if (loggedIn) {
        await signOut(auth);
        sessionStorage.clear();
        location.reload();
      } else {
        location.href = "login.html";
      }
    });

    applyState();
  </script>
</body>
</html>
